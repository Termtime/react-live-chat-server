(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{105:function(e,t,s){},106:function(e,t,s){"use strict";s.r(t);var c=s(0),n=s(1),r=s.n(n),o=s(21),a=s.n(o),i=(s(59),s(39),s(60),s(61),s(7)),l=s(25),d=s(10),u=(s(67),s(35)),j=s.n(u),m=s(3),b=function(e){return Object(c.jsx)("div",{className:"row message",children:Object(c.jsxs)("div",{className:"col",children:[Object(c.jsx)("div",{className:"row",children:Object(c.jsx)("small",{className:"username",children:e.user.username})}),Object(c.jsx)("div",{className:"row ",children:Object(c.jsx)("p",{className:"wrap messageText",children:e.message.body})}),Object(c.jsx)("div",{className:"row timeStamp",children:Object(c.jsx)("small",{children:e.message.time})})]})})},O=function(e){return Object(c.jsx)("div",{className:"row ownMessage",children:Object(c.jsxs)("div",{className:"col",children:[Object(c.jsx)("div",{className:"row",children:Object(c.jsx)("p",{className:"wrap messageText",children:e.message.body})}),Object(c.jsx)("div",{className:"row timeStamp",children:Object(c.jsx)("small",{children:e.message.time})})]})})},h=s.p+"static/media/exit.f0dbdb09.svg",p="USER_JOINED",x="DISCONNECTED",f="RECEIVED_MSG",g="CONNECT",v="INITIALIZE",N="JOIN_ROOM",y=Object(i.b)((function(e){return{messages:e.messages,users:e.users,ownUser:e.ownUser,roomId:e.roomId}}),(function(e){return{disconnect:function(){return e({type:x})}}}))((function(e){var t=Object(m.f)();return Object(c.jsxs)("div",{className:"col messageBox-container",children:[Object(c.jsxs)("div",{className:"row messageBox-container-header",children:[Object(c.jsx)("div",{className:"col",children:Object(c.jsxs)("p",{children:["Room: ",e.roomId," "]})}),Object(c.jsx)("div",{className:"col text-right",children:Object(c.jsxs)("div",{className:"row right text-right",children:[Object(c.jsxs)("p",{style:{lineHeight:"3vh"},children:[e.users.length," ","".concat(1===e.users.length?"user":"users")," ","online"]}),Object(c.jsx)("img",{id:"exit-btn",src:h,onClick:function(){e.disconnect(),t.push("/")}})]})})]}),Object(c.jsx)("div",{id:"messages",className:"row ",children:Object(c.jsx)("div",{className:"col",children:e.messages.map((function(t,s){return t.user.id===e.ownUser.id?Object(c.jsx)(O,{message:t},s):Object(c.jsx)(b,{message:t,user:t.user},s)}))})})]})})),w=null,S=Object(i.b)((function(e){return{socket:e.socket,ownUser:e.ownUser,roomId:e.roomId}}),(function(e){return{}}))((function(e){var t=Object(n.useState)(""),s=Object(d.a)(t,2),r=s[0],o=s[1];function a(t){if(t&&t.preventDefault(),0!==r.trim().length){var s={body:r,user:e.ownUser,roomId:e.roomId,date:new Date,time:(new Date).toLocaleTimeString("en-US")};o(""),e.socket.current.emit("send-msg",s)}}function i(){!1,e.socket.current.emit("clientStoppedTyping",e.ownUser.id),w=null}return Object(c.jsxs)("form",{style:{alignItems:"flex-end"},className:"row form-inline",onSubmit:a,children:[Object(c.jsx)("textarea",{id:"msgInput",rows:"1",className:"form-control",value:r,onInput:function(t){w?clearTimeout(w):e.socket.current.emit("isTyping"),w=setTimeout(i,3e3),o(t.target.value)},onKeyDown:function(e){13!=e.keyCode||e.shiftKey||(w&&clearTimeout(w),i(),a(),e&&e.preventDefault())},placeholder:"Write something..."}),Object(c.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Send"})]})})),I=s.p+"static/media/user.4ad10357.svg",T=function(e){return Object(c.jsxs)("div",{className:"userlist-username",children:[Object(c.jsx)("img",{src:I,className:"avatar"}),Object(c.jsx)("span",{children:e.user.username})]})},U=Object(i.b)((function(e){return{users:e.users}}),(function(e){return{}}))((function(e){return Object(c.jsx)("div",{className:"userList-container",children:Object(c.jsxs)("div",{className:"userList",children:[Object(c.jsx)("div",{id:"userlist-title",className:"row center",children:Object(c.jsx)("p",{children:"Users"})}),Object(c.jsx)("div",{id:"users",children:e.users.map((function(e){return Object(c.jsx)(T,{user:e})}))})]})})})),k=Object(i.b)((function(e){return{users:e.users,socketREF:e.socket,messages:e.messages,roomId:e.roomId,ownUser:e.ownUser}}),(function(e){return{disconnect:function(){return e({type:x})},connect:function(t){return e({type:g,payload:t})},initialize:function(t){return e({type:v,payload:t})},receivedMessage:function(t){return e({type:f,payload:t})},updateUserlist:function(t){return e({type:p,payload:t})}}}))((function(e){var t=Object(n.useState)([]),s=Object(d.a)(t,2),r=s[0],o=s[1],a=Object(m.f)(),i=Object(n.useRef)(),u=Object(n.useRef)(),b=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_BACKEND_URL||"http://localhost:8000";return Object(n.useEffect)((function(){return e.roomId&&e.ownUser.username?(i.current=j.a.connect(b),e.initialize(i),i.current.on("own-id",(function(t){var s={username:e.ownUser.username,id:t,room:e.roomId};e.connect(s),i.current.emit("presentation",s)})),i.current.on("userlist-update",(function(t){e.updateUserlist(t),u.current=t,console.log("user list has been updated",u.current)})),i.current.on("msg",(function(t){!function(t){e.receivedMessage(t),document.querySelector("#messages").scrollTo(0,document.querySelector("#messages").scrollHeight)}(t)})),i.current.on("isTyping",(function(e){console.log("someones typing"),console.log(u.current),console.log(e);var t=u.current.find((function(t){return t.id===e}));void 0===t?console.log("undefined user found typing, almost crashed"):o([].concat(Object(l.a)(r),[t]))})),i.current.on("stoppedTyping",(function(e){void 0===u.current.find((function(t){return t.id===e}))?console.log("undefined user found to have stopped typing, almost crashed"):o(r.filter((function(t){return t.id!==e})))})),function(){i.current.close(),e.disconnect()}):(a.push("/"),void e.disconnect())}),[]),Object(c.jsx)("div",{className:"flex-container col App ",children:Object(c.jsxs)("div",{id:"app",children:[Object(c.jsxs)("div",{className:"row",children:[Object(c.jsx)(y,{}),Object(c.jsx)(U,{})]}),Object(c.jsx)("div",{id:"typingStatus",children:r.map((function(e,t){return Object(c.jsxs)("small",{children:[e.username," is typing..."]},"".concat(e.id,"-typing"))}))}),Object(c.jsx)(S,{})]})})})),E=(s(105),Object(i.b)((function(e){return{}}),(function(e){return{setRoom:function(t){return e({type:N,payload:t})}}}))((function(e){var t=Object(m.f)(),s=Object(n.useState)(""),r=Object(d.a)(s,2),o=r[0],a=r[1],i=Object(n.useState)(""),l=Object(d.a)(i,2),u=(l[0],l[1],Object(n.useState)("")),j=Object(d.a)(u,2),b=j[0],O=j[1];return Object(c.jsx)("div",{className:"homepage",children:Object(c.jsxs)("div",{className:"",children:[Object(c.jsxs)("div",{className:"homepage-header",children:[Object(c.jsxs)("div",{className:"whiteTxt",children:[Object(c.jsx)("div",{className:"row center",children:Object(c.jsx)("h1",{children:" Welcome to Live-chat!"})}),Object(c.jsx)("div",{className:"row center",children:Object(c.jsx)("h3",{children:" Join chat rooms, and talk to your friends!"})})]}),Object(c.jsxs)("form",{onSubmit:function(s){s&&s.preventDefault(),console.log("pushing route"),e.setRoom({room:b,username:o}),t.push("/room"),console.log("route pushed")},children:[Object(c.jsx)("div",{className:"offset-2 col-8 ",children:Object(c.jsxs)("div",{className:"input-group flex-nowrap",children:[Object(c.jsx)("div",{className:"input-group-prepend",children:Object(c.jsx)("label",{children:Object(c.jsx)("span",{className:"input-group-text",children:"Username:"})})}),Object(c.jsx)("input",{type:"text",className:"form-control",value:o,onInput:function(e){return a(e.target.value)},placeholder:"Termtime",required:!0})]})}),Object(c.jsx)("br",{}),Object(c.jsx)("div",{className:"center form-inline",children:Object(c.jsxs)("div",{className:"input-group",children:[Object(c.jsx)("div",{className:"input-group-prepend",children:Object(c.jsx)("label",{children:Object(c.jsx)("span",{className:"input-group-text",children:"Room name:"})})}),Object(c.jsx)("input",{type:"text",className:"form-control",placeholder:"Termtime's room",value:b,onInput:function(e){return O(e.target.value)},required:!0}),Object(c.jsx)("div",{className:"input-group-append",children:Object(c.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Join"})})]})})]}),Object(c.jsx)("br",{})]}),Object(c.jsx)("div",{className:"homepage-bottom",children:Object(c.jsxs)("div",{className:"row center",children:[Object(c.jsx)("div",{className:"col-3",children:Object(c.jsx)("div",{className:"card ",children:Object(c.jsxs)("div",{className:"card-body text-dark",children:[Object(c.jsxs)("h3",{className:"card-title ",children:[Object(c.jsx)("b",{children:"What"})," do we do?"]}),Object(c.jsx)("hr",{}),Object(c.jsx)("p",{children:"Offer a free space to chat and talk with friends or random people about common topics or interests."})]})})}),Object(c.jsx)("div",{className:"col-3",children:Object(c.jsx)("div",{className:"card",children:Object(c.jsxs)("div",{className:"card-body text-dark",children:[Object(c.jsxs)("h3",{className:"card-title ",children:[Object(c.jsx)("b",{children:"How"})," do we do it?"]}),Object(c.jsx)("hr",{}),Object(c.jsx)("p",{children:"Using Express and Socket.io with rooms we can connect people through a simple WebApp."})]})})}),Object(c.jsx)("div",{className:"col-3",children:Object(c.jsx)("div",{className:"card",children:Object(c.jsxs)("div",{className:"card-body text-dark",children:[Object(c.jsxs)("h3",{className:"card-title ",children:[Object(c.jsx)("b",{children:"Why"})," do we do it?"]}),Object(c.jsx)("hr",{}),Object(c.jsx)("p",{children:"Because there is always a need to explore new and fun ways to use and apply technology in daily life."})]})})})]})})]})})}))),C=s(13),D=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,107)).then((function(t){var s=t.getCLS,c=t.getFID,n=t.getFCP,r=t.getLCP,o=t.getTTFB;s(e),c(e),n(e),r(e),o(e)}))},R=s(23),_=s(9),L={ownUser:{},socket:{},users:[],messages:[],roomId:""};var A=Object(R.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(console.log(e,t),t.type){case N:return Object(_.a)(Object(_.a)({},e),{},{ownUser:{username:t.payload.username},roomId:t.payload.room});case x:return e.socket&&e.socket.current&&e.socket.current.close(),L;case p:return Object(_.a)(Object(_.a)({},e),{},{users:t.payload});case g:return Object(_.a)(Object(_.a)({},e),{},{ownUser:t.payload});case v:return Object(_.a)(Object(_.a)({},e),{},{socket:t.payload});case f:return Object(_.a)(Object(_.a)({},e),{},{messages:[].concat(Object(l.a)(e.messages),[t.payload])});default:return e}}));a.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(C.a,{children:Object(c.jsx)(i.a,{store:A,children:Object(c.jsxs)(m.c,{children:[Object(c.jsx)(m.a,{exact:!0,path:"/",component:E}),Object(c.jsx)(m.a,{exact:!0,path:"/room",component:k})]})})})}),document.getElementById("root")),D()},59:function(e,t,s){},67:function(e,t,s){},99:function(e,t){}},[[106,1,2]]]);
//# sourceMappingURL=main.71fbc8a6.chunk.js.map